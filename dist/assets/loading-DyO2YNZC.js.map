{"version":3,"file":"loading-DyO2YNZC.js","sources":["../../src/assets/image/Loading.gif","../../src/utils/loading.js"],"sourcesContent":["export default \"__VITE_ASSET__BX$7kbc7__\"","import {reactive, ref} from \"vue\";\nimport { ElLoading } from \"element-plus\";\nimport loadingGif from \"../assets/image/Loading.gif\"\n\nconst state = reactive({\n    isRunning: false,\n    component: null,\n    text: '試算中',\n    timers: [undefined, undefined]\n})\n\nexport const useLoadingServer = () => {\n    const startTextTimer = () => {\n        return setInterval(() => {\n            if (state.text === '試算中...') {\n                state.text = '試算中'\n            }\n            else {\n                state.text += '.'\n            }\n            state.component.setText(state.text);\n        }, 1000)\n    }\n\n    const startImgTimer = () => {\n        return setInterval(() => {\n            // 添加隨機數，避免瀏覽器緩存\n            state.component.$el.style.backgroundImage = `url(${loadingGif}?${Math.random()})`\n        }, 4000)\n    }\n\n    const show = () => {\n        if (state.component && state.isRunning) { return }\n        state.component = ElLoading.service({\n            lock: true,\n            fullscreen: true,\n            text: state.text,\n            background: 'rgba(0, 0, 0, 0.9)'\n        })\n        state.timers = [ startTextTimer(), startImgTimer() ]\n        state.isRunning = true;\n    }\n\n    const close = () => {\n        const closeTimer = setTimeout(() => {\n            state.component.close();\n            state.component = null;\n            state.timers.forEach(clearInterval);\n            state.isRunning = false;\n            clearTimeout(closeTimer)\n        }, 4000)\n    }\n\n    const isRunning = () => { return state.isRunning; }\n\n    return {\n        show,\n        close,\n        isRunning\n    }\n}"],"names":["loadingGif","state","useLoadingServer","startTextTimer","startImgTimer","closeTimer"],"mappings":"AAAA,MAAeA,EAAA,mCCIfC,EAAc,IAAQ,SAAA,CACtB,UAAA,GACA,UAAA,KACA,KAAA,MACA,OAAA,CAAA,OAAA,MAAA,CACA,CAAA,EAEAC,EAAA,IAAA,CACA,MAAAC,EAAA,IACA,YAAA,IAAA,CACAF,EAAA,OAAA,SACAA,EAAA,KAAA,MAGAA,EAAA,MAAA,IAEAA,EAAA,UAAA,QAAAA,EAAA,IAAA,CACA,EAAA,GAAA,EAGAG,EAAA,IACA,YAAA,IAAA,CAEAH,EAAA,UAAA,IAAA,MAAA,gBAAA,OAAAD,CAAA,IAAA,KAAA,OAAA,CAAA,GACA,EAAA,GAAA,EA2BA,MAAA,CACA,KAzBA,IAAA,CACAC,EAAA,WAAAA,EAAA,YACAA,EAAA,UAA0B,YAAS,UAAA,QAAA,CACnC,KAAA,GACA,WAAA,GACA,KAAAA,EAAA,KACA,WAAA,oBACA,CAAA,EACAA,EAAA,OAAA,CAAAE,EAAA,EAAAC,EAAA,CAAA,EACAH,EAAA,UAAA,GACA,EAgBA,MAdA,IAAA,CACA,MAAAI,EAAA,WAAA,IAAA,CACAJ,EAAA,UAAA,QACAA,EAAA,UAAA,KACAA,EAAA,OAAA,QAAA,aAAA,EACAA,EAAA,UAAA,GACA,aAAAI,CAAA,CACA,EAAA,GAAA,CACA,EAOA,UALA,IAAAJ,EAAA,SAMA,CACA"}